---
import Layout from '../../layouts/Layout.astro';
import Menu from '../../components/Menu.astro';
import esUI from '../../i18n/es.json';
import enUI from '../../i18n/en.json';
import esMenu from '../../data/menu.es.json';
import enMenu from '../../data/menu.en.json';

export function getStaticPaths() {
  return [
    { params: { lang: 'es' } },
    { params: { lang: 'en' } },
  ];
}

const { lang } = Astro.params;
const ui = lang === 'es' ? esUI : enUI;
const menuData = lang === 'es' ? esMenu : enMenu;
---

<Layout lang={lang} title={ui.site.title} description={ui.site.description}>
  <div class="absolute top-4 right-4 z-10">
    <a href="/es/" class:list={[{'font-bold underline': lang === 'es'}, "text-white px-2 py-1"]}>ES</a>
    <span class="text-white">|</span>
    <a href="/en/" class:list={[{'font-bold underline': lang === 'en'}, "text-white px-2 py-1"]}>EN</a>
  </div>

  <main class="relative">
    <header class="relative h-screen bg-cover bg-center" style="background-image: url('/assets/restaurant-photo.webp');">
      <div class="absolute inset-0 bg-black bg-opacity-50 flex flex-col justify-center items-center text-center text-white p-4">
        <img src="/assets/logo.jpg" alt="Soda Marcela Logo" class="w-48 md:w-64 mb-4 rounded-full shadow-lg" />
        <h1 class="text-4xl md:text-6xl font-serif font-bold mb-2">{ui.site.title.split('- ')[0]}</h1>
        <p class="text-lg md:text-2xl font-sans" set:html={ui.hero.subtitle} />
        <p class="text-md md:text-xl font-sans mt-2">{ui.hero.location}</p>
        <button id="menu-button" class="mt-8 bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300 shadow-lg">
          {ui.hero.menu_button}
        </button>
      </div>
    </header>

    <section id="about" class="py-20 px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl font-serif font-bold mb-4">{ui.about.title}</h2>
      <p class="max-w-3xl mx-auto text-lg leading-relaxed" set:html={ui.about.body} />
    </section>

    <section id="services" class="bg-amber-50 py-20 px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl font-serif font-bold mb-4">{ui.services.title}</h2>
      <p class="max-w-3xl mx-auto text-lg leading-relaxed" set:html={ui.services.body} />
      <a href="tel:+506XXXXXXXX" class="mt-6 inline-block bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300 shadow-lg">
        {ui.services.order_button}
      </a>
    </section>

    <footer class="bg-gray-800 text-white py-12 px-4 sm:px-6 lg:px-8 text-center">
      <p>&copy; {new Date().getFullYear()} Soda Marcela. {ui.footer.copyright}</p>
      <p>{ui.hero.location}</p>
    </footer>

    <div id="menu-modal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center p-4 z-50">
      <div class="bg-amber-50 w-full max-w-4xl h-full max-h-[90vh] rounded-lg shadow-xl overflow-y-auto p-8 relative">
        <button id="close-menu-button" class="absolute top-4 right-4 text-3xl font-bold text-gray-700 hover:text-black leading-none">&times;</button>
        <h2 class="text-4xl font-serif font-bold text-center mb-8">{ui.menu.title}</h2>
        <div id="menu-content">
          <Menu menuData={menuData} />
        </div>
      </div>
    </div>
  </main>

  <script>
    const menuButton = document.getElementById('menu-button');
    const closeMenuButton = document.getElementById('close-menu-button');
    const menuModal = document.getElementById('menu-modal');

    if (menuButton && menuModal && closeMenuButton) {
      menuButton.addEventListener('click', () => {
        menuModal.classList.remove('hidden');
        menuModal.classList.add('flex');
      });

      closeMenuButton.addEventListener('click', () => {
        menuModal.classList.add('hidden');
        menuModal.classList.remove('flex');
      });

      menuModal.addEventListener('click', (event) => {
        if (event.target === menuModal) {
          menuModal.classList.add('hidden');
          menuModal.classList.remove('flex');
        }
      });
    }
  </script>
</Layout>
